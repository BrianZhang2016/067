<!-- Navigation Bar from bootstrap
This HTML is setup as a fragment allowing it to be "included" by other HTML files via Jinja2
-->
<head>
    <script>

    </script>
    <style>
        nav.navbar {
            position: relative;
        }
        #form-group {
            position: absolute;
            padding: 1em;
            background-color: var(--white);
            width: 30%;
            top: 50px;
        }
        #form-group input, #form-group button {
            width: 100%
        }
        #result {
            color: var(--turqoise)
        }
    </style>
</head>

<body>
    <nav class="navbar navbar-expand-lg navbar-light" style="background-color: rgb(255,255,255);">
        <a class="navbar-brand" href="https://csp.nighthawkcodingsociety.com/">{{name}}</a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNavAltMarkup">
            <div class="navbar-nav">
                <!-- url_for is a Jinja2 pre-processor that finds route from function name (def) -->
                <a class="nav-link" style="color: #ed1b76" href={{ url_for('index') }}>Portfolio </a>
                <!-- stub is shown using the name of the route -->
                <div class="collapse navbar-collapse" id="navbarSupportedContent">
                    <ul class="navbar-nav mr-auto">
                        <!--root menu -->
                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle" href="#" id="navbarStarters" style="color: #ed1b76" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                Greet Pages
                            </a>
                            <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                                <a class="dropdown-item" href="/zachgreet">Zachary's Greet</a>
                                <a class="dropdown-item" href="/briangreet">Brian's Greet</a>
                                <a class="dropdown-item" href="/stanley">Stanley's Greet</a>
                                <a class="dropdown-item" href="/leo">Leo's Greet</a>
                            </div>
                        </li>
                        <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="navbarStarters" style="color: #ed1b76" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            Our Games
                        </a>
                        <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                            <a class="dropdown-item" href="/spaceClick">Space Click</a>
                            <a class="dropdown-item" href="/guessTheNumber">Guess the Number</a>

                        </div>
                        </li>
                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle" href="#" id="navbarStarters" style="color: #ed1b76" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                APIs
                            </a>
                            <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                                <a class="dropdown-item" href="/movieapi">Movie Api</a>
                            </div>
                        </li>
                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle" href="#" id="navbarStarters" style="color: #ed1b76" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                Databases
                            </a>
                            <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                                <a class="nav-link" href={{ url_for('crud.crud') }}>SQL Crud </a>
                                <a class="nav-link" href={{ url_for('crud.search') }}>SQL Search</a>
                            </div>
                        </li>
                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle" href="#" id="navbarStarters" style="color: #ed1b76" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                Pages
                            </a>
                            <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                                <a class="dropdown-item" href="/movies">Best Rated Movies</a>
                                <a class="dropdown-item" href="/moviequiz">Movie Quiz</a>
                            </div>
                        </li>
                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle" href="#" id="navbarStarters" style="color: #ed1b76" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                Review Pages
                            </a>
                            <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                                <a class="dropdown-item" href="/arcade">Movies</a>
                                <a class="dropdown-item" href="/arcade2">TV Shows</a>
                                <a class="dropdown-item" href="/stub">Temp Review</a>
                                <a class="dropdown-item" href={{ url_for('colorCode') }}>Temp Review 2</a>

                            </div>
                        </li>
                        <div style="display: flex; align-items: center" onclick="showSearch()">
                            <i style="color: black" class="fas fa-search"></i>
                        </div>
                        <div id="form-group" class="form-group" style="display: block">
                            <input type="text" class="form-control" id="term" placeholder="enter search term" autocomplete="off">
                            <button onclick="search_data()">Search Data</button>
                            <div class="container">
                                <div class="column" id="result">
                                </div>
                            </div>

                        </div>
                    </ul>
                </div>
            </div>
        </div>
    </nav>
    <script>
            function showSearch() {
                if (document.getElementById("form-group").style.display == "none") {
                    document.getElementById("form-group").style.display = "block"
                } else {
                    document.getElementById("form-group").style.display = "none"
                }
            }
            function search_data() {
                // fetch standard requires data set to a name-value pair
                const term = document.getElementById("term");
                const body = {
                    term: term.value
                };

                // fetch call with header options
                fetch('/crud/search/term/', {
                    method: "POST",
                    credentials: "include",
                    body: JSON.stringify(body),
                    cache: "no-cache",
                    headers: new Headers({
                        "content-type": "application/json"
                    })
                })
                // async then replies with response header
                .then(function (response) {
                    // prepare HTML search result container for new output
                    const resultContainer = document.getElementById("result");
                    // clean up from previous search
                    while (resultContainer.firstChild) {
                        resultContainer.removeChild(resultContainer.firstChild);
                    }
                    // trap error response from Web API
                    if (response.status !== 200) {
                        const errorMsg = 'Database response error: ' + response.status;
                        console.log(errorMsg);
                        const div = document.createElement("div");
                        div.innerHTML = errorMsg;
                        resultContainer.appendChild(div);
                        return;
                    }
                    // response contains valid result
                    response.json().then(function(data) {
                        // loop through JSON and build HTML output
                        for (let i = 0; i < data.length; i++) {
                            const div = document.createElement("div");
                            div.innerHTML = 'Class Name:' + data[i].className + ', Teacher:' + data[i].teacher + ', Link:' + data[i].link;
                            resultContainer.appendChild(div);
                        }
                    })
                })
            }
    </script>
</body>


